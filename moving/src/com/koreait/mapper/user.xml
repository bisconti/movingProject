<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="User">
   <insert id="join" parameterType="userdto">
      insert into user values(#{userid},#{userpw},#{username},#{usergender},
      #{zipcode},#{useraddr},#{useraddrdetail},#{useraddretc},#{userbirth}, #{userphone})
   </insert>
   <select id="login" parameterType="hashmap" resultType="_int">
      select count(*) from user where userid=#{userid} and userpw=#{userpw}
   </select>
   <select id="checkId" parameterType="string" resultType="_int">
      select count(*) from user where userid=#{userid}
   </select>
   <select id="searchId" parameterType="string" resultType="string">
      select userid from user where userphone=#{userphone}
   </select>
   <update id="updatePw" parameterType="hashmap">
      update user set userpw=#{userpw} where userid=#{userid}
   </update>
   <update id="profileUpdate" parameterType="string">
      update user set image=#{vo.getNewFileName} where userid=#{userid}
   </update>
   	<select id="checkSubscribe" parameterType="string" resultType="date">
		select date from pay where userid=#{userid}
	</select>
	<select id="getLoginUser" parameterType="string" resultType="userdto">
        select * from user where userid = #{userid}
   </select>
   	<select id="getUserAge" parameterType="string" resultType="_int">
      SELECT FLOOR( (CAST(REPLACE(CURRENT_DATE,'-','') AS UNSIGNED) - 
       CAST(REPLACE(#{userbirth},'-','') AS UNSIGNED)) / 10000 );
   </select>
</mapper>